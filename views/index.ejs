<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>TkVault</title>
  <link rel="stylesheet" type="text/css" href="css/style.css">
  <link rel="icon" href="/favicon.ico">
</head>
<body>
  <div class="title">
    TkVault
    <div class="subtitle">
      File Upload System
    </div>
    <div class="title">
      <img src="https://media.tenor.com/7GzWtl6kvcgAAAAi/bocchi-the-rock.gif">
    </div>
  </div>
  <form action="/upload" method="post" enctype="multipart/form-data">
    <input type="file" name="file" required>
    <button type="submit">Upload</button>
    <p>12 MB upload limit.</p>
  </form>

  <hr>

  <!-- List of uploaded files -->
  <div class="title">Uploaded Files</div>
  <ul id="fileList">
    <% function formatBytes(bytes, decimals = 2) {
      if (bytes === 0) return '0 Bytes';
    
      const k = 1024;
      const dm = decimals < 0 ? 0 : decimals;
      const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];
    
      const i = Math.floor(Math.log(bytes) / Math.log(k));
    
      return parseFloat((bytes / Math.pow(k, i)).toFixed(dm)) + ' ' + sizes[i];
    } %>

    <% files.forEach(file => { %>
      <li>
        <a href="/uploads/<%= file.fileName %>"><%= file.fileName %></a> (<%= formatBytes(file.fileSize) %>)
        <p>IP: <%= file.uploaderIP %></p>
        <p>Date: <%= new Date(file.uploadTime).toLocaleString() %></p>
      </li>
    <% }); %>
  </ul>
</body>
</html>